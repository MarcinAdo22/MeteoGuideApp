<!DOCTYPE html>
<html lang="pl">
    <head>
    <meta charset="utf-8">
    <title>Homepage</title>
    <link rel = "stylesheet" type="text/css" href="register_user.css">

    </head>
    <body>
        <div id="login_container">
            <form id="login_form" action="/register" method = "POST">

                <strong id="register_heading">Zarejestruj się</strong>
                <div class="input-row">
                    <label for="username">Podaj imię:</label>
                <input type="text" placeholder="Twoje imię " name="first_name">
                </div>

                <div class="input-row">
                    <label for="username">Podaj nazwisko:</label>
                <input type="text" placeholder="Twoje nazwisko " name="last_name">
                </div>

                <div class="input-row">
                    <label for="username">Podaj mail:</label>
                <input type="text" placeholder="Twój email " name="user_name">
                </div>

                <div class="input-row">
                    <label for="username">Podaj hasło:</label>
                <input type="password" placeholder="Twoje hasło " name="user_password">
                </div>

                
                <div class="input-row">
                    <label for="username">Podaj miasto:</label>
                <input type="text" placeholder="Twoje miasto " name="city" id="city">
                </div>


                <div id="submit_login">

                    <a id="link_to_login_form" href="./login">Masz konto? Zaloguj się! </a>
                    <button type="submit" >Utworz konto</button>
                    
                </div>
                
                <p id="Error_register_miasto" style="display: none; color: red;">Nie ma takiego miasta! Spróbuj ponownie</p>
                <p id="Error_uzytkownik_istnieje" style="display: none; color: red;">Błąd! Użytkownik istnieje! </p> <!-- TODO !!! -->


            </form>
        </div>
    </body>
</html>

<script>
  document.getElementById("login_form").addEventListener("submit", async function (e) {
    e.preventDefault();
    const city = document.getElementById("city").value.trim();

    const apiKey = "1a66f3f14813d8f773616d86e35fdc04";

    const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`);

    if (!response.ok) {
        Error_register_miasto.style.display = "block";
        return;
    }
      e.target.submit();


  });
</script>
